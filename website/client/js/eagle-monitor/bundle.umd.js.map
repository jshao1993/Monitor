{"version":3,"file":"bundle.umd.js","sources":["../../../../eagle-sdk/errorCatch.js","../../../../eagle-sdk/index.js"],"sourcesContent":["let formatError = errorObj => {\r\n    debugger\r\n    let col = errorObj.column || errorObj.columnNumber // 兼容safari和firefox，谷歌没有列信息\r\n    let row = errorObj.line || errorObj.lineNumber // 兼容safari和firefox，谷歌没有行信息\r\n    let errorType = errorObj.name\r\n    let message = errorObj.message\r\n\r\n    let { stack } = errorObj\r\n    // chrome 没有行列信息\r\n    if (stack) {\r\n        // matchUrl 里面有报错url和报错的位置\r\n        let matchUrl = stack.match(/https?:\\/\\/[^\\n]+/) // 匹配栈顶的报错\r\n        let urlFirstStack = matchUrl ? matchUrl[0] : ''\r\n        // \"http://localhost:3003/js/main.js:31:5)\"\r\n\r\n        // 获取真正的url\r\n        let resourceUrl = ''\r\n        let regUrlCheck = /https?:\\/\\/(\\S)*\\.js/\r\n        if (regUrlCheck.test(urlFirstStack)) {\r\n            resourceUrl = urlFirstStack.match(regUrlCheck)[0]\r\n        }\r\n\r\n        // 获取真正的行列信息\r\n        let stackCol = null\r\n        let stackRow = null\r\n        let posStack = urlFirstStack.match(/:(\\d+):(\\d+)/) // \"http://localhost:3003/js/main.js:31:5)\"\r\n        if (posStack && posStack.length >= 3) {\r\n            [, stackRow, stackCol] = posStack\r\n        }\r\n\r\n        //TODO formatStack\r\n        return {\r\n            content: stack,\r\n            col: Number(stackCol || col),\r\n            row: Number(stackRow || row),\r\n            errorType,\r\n            message,\r\n            resourceUrl\r\n        }\r\n    }\r\n}\r\n\r\nexport default {\r\n    init: (cb) => {\r\n        let _origin_error = window.onerror\r\n        window.onerror = function (message, source, lineno, colno, error) {\r\n            console.dir(error, 'error')\r\n            debugger\r\n            try {\r\n                let errorInfo = formatError(error)\r\n                // 原生信息\r\n                errorInfo._message = message\r\n                errorInfo._source = source\r\n                errorInfo._lineno = lineno\r\n                errorInfo._colno = colno\r\n                errorInfo.type = 'onerror'\r\n                cb(errorInfo)\r\n                _origin_error && _origin_error.apply(window, arguments)\r\n            } catch (error) {\r\n                console.log(error)\r\n            }\r\n        }\r\n    }\r\n}","// import perf from './perf'\r\n// import resource from './resource'\r\n// import xhrHook from './xhrHook'\r\nimport errorCatch from './errorCatch'\r\n// import behavior from './behavior'\r\n\r\n// new Image(`http://dasdasdad.gif?type=error&data=${xhrInfo}`)\r\n\r\n// perf.init((perfData) => {\r\n//     console.log('perf init')\r\n// })\r\n\r\n// resource.init((resourceData) => {\r\n//     console.log(resourceData, 'resourceData')\r\n// })\r\n\r\n// xhrHook.init((xhrData) => {\r\n//     console.log(xhrData, 'xhrData')\r\n// })\r\n\r\nerrorCatch.init((errorData) => {\r\n    console.log(errorData, 'errorData')\r\n})\r\n\r\n// behavior.init((behaviorData) => {\r\n//     console.log(behaviorData, 'behaviorData')\r\n// })\r\n\r\n// 打点，封装一个log函数一直往服务器传"],"names":["formatError","errorObj","col","column","columnNumber","row","line","lineNumber","errorType","name","message","stack","matchUrl","match","urlFirstStack","resourceUrl","regUrlCheck","test","stackCol","stackRow","posStack","length","content","Number","init","cb","_origin_error","window","onerror","source","lineno","colno","error","console","dir","errorInfo","_message","_source","_lineno","_colno","type","apply","arguments","log","errorCatch","errorData"],"mappings":"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"}